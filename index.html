<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TreeToCLI - Developer Tool</title>

<!-- UPDATED: Favicon -->
<link rel="icon" type="image/png" href="treetoclilogo.png">

<!-- Fonts: Inter for UI, JetBrains Mono for Code -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

<style>
:root {
    /* Dark Theme Variables (Default) */
    --bg-body: #0f172a;
    --bg-gradient: radial-gradient(circle at top left, #1e293b, #0f172a);
    --glass-bg: rgba(30, 41, 59, 0.7);
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-highlight: rgba(255, 255, 255, 0.05);
    --text-primary: #f8fafc;
    --text-secondary: #94a3b8;
    --accent-primary: #3b82f6; /* Blue */
    --accent-glow: rgba(59, 130, 246, 0.5);
    --accent-hover: #2563eb;
    --success: #10b981;
    --code-bg: rgba(15, 23, 42, 0.8);
    --line-numbers: #334155;
    
    /* Syntax Highlighting */
    --syntax-dir: #38bdf8; /* Sky Blue */
    --syntax-file: #facc15; /* Yellow */
    
    /* Spacing & Radius */
    --radius-lg: 16px;
    --radius-md: 8px;
    --header-height: 70px;
}

body.light {
    /* Light Theme Variables */
    --bg-body: #f1f5f9;
    --bg-gradient: linear-gradient(135deg, #f8fafc, #e2e8f0);
    --glass-bg: rgba(255, 255, 255, 0.85);
    --glass-border: rgba(0, 0, 0, 0.08);
    --glass-highlight: rgba(255, 255, 255, 0.5);
    --text-primary: #1e293b;
    --text-secondary: #64748b;
    --accent-primary: #2563eb;
    --accent-glow: rgba(37, 99, 235, 0.2);
    --accent-hover: #1d4ed8;
    --code-bg: rgba(241, 245, 249, 0.9);
    --line-numbers: #cbd5e1;
    
    --syntax-dir: #0284c7;
    --syntax-file: #d97706;
}

* { box-sizing: border-box; outline: none; }

body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: var(--bg-body);
    background-image: var(--bg-gradient);
    background-attachment: fixed;
    height: 100vh;
    color: var(--text-primary);
    overflow: hidden; /* Prevent body scroll, handle inside containers */
    transition: background 0.5s ease, color 0.3s ease;
}

/* --- Header --- */
header {
    height: var(--header-height);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    border-bottom: 1px solid var(--glass-border);
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    z-index: 10;
}

.brand {
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 700;
    font-size: 1.25rem;
    letter-spacing: -0.5px;
    color: var(--text-primary);
}

/* Logo Styles */
.brand-logo-img {
    height: 70px;
    width: 100px;
    border-radius: 20px;
    object-fit: contain;
    transition: transform 0.3s;
}

.brand-logo-img:hover {
    transform: scale(1.05);
}

.brand-logo-svg {
    width: 32px;
    height: 32px;
    fill: var(--accent-primary);
    filter: drop-shadow(0 0 8px var(--accent-glow));
    display: none; /* Hidden by default, shown via JS on error */
}

.header-controls {
    display: flex;
    gap: 12px;
}

.icon-btn {
    background: transparent;
    border: 1px solid var(--glass-border);
    color: var(--text-secondary);
    padding: 8px;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.icon-btn:hover {
    background: var(--glass-highlight);
    color: var(--text-primary);
    border-color: var(--accent-primary);
}

.icon-btn svg { width: 20px; height: 20px; fill: currentColor; }

/* --- Main Layout --- */
main {
    height: calc(100vh - var(--header-height));
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    padding: 20px;
    max-width: 1800px;
    margin: 0 auto;
}

/* --- Panels (Input & Output) --- */
.panel {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    backdrop-filter: blur(10px);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.panel:focus-within {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px var(--accent-glow);
}

.panel-header {
    padding: 12px 20px;
    border-bottom: 1px solid var(--glass-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255,255,255,0.02);
}

.panel-title {
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.panel-actions {
    display: flex;
    gap: 8px;
}

/* --- Input Area --- */
.editor-container {
    flex: 1;
    position: relative;
    background: var(--code-bg);
}

textarea {
    width: 100%;
    height: 100%;
    border: none;
    background: transparent;
    color: var(--text-primary);
    font-family: 'JetBrains Mono', monospace;
    font-size: 14px;
    line-height: 1.6;
    padding: 20px;
    resize: none;
}

textarea::placeholder { color: var(--text-secondary); opacity: 0.5; }

/* Drag Overlay */
.drag-overlay {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(59, 130, 246, 0.1);
    border: 2px dashed var(--accent-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    color: var(--accent-primary);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
    z-index: 5;
}

textarea.dragover + .drag-overlay { opacity: 1; }

/* --- Output Area --- */
.output-container {
    flex: 1;
    background: var(--code-bg);
    overflow-y: auto;
    position: relative;
    padding: 20px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 14px;
    line-height: 1.6;
}

/* Custom Scrollbar */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 5px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

/* --- Controls & Buttons --- */
.btn {
    border: none;
    padding: 8px 14px;
    border-radius: var(--radius-md);
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
}

.btn-primary {
    background: var(--accent-primary);
    color: white;
    box-shadow: 0 2px 10px var(--accent-glow);
}

.btn-primary:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
}

.btn-ghost {
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid transparent;
}

.btn-ghost:hover {
    background: var(--glass-highlight);
    color: var(--text-primary);
}

/* --- OS Switcher (Segmented Control) --- */
.os-switcher {
    background: rgba(0,0,0,0.2);
    padding: 4px;
    border-radius: var(--radius-md);
    display: flex;
    gap: 4px;
}

.os-option {
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 0.8rem;
    cursor: pointer;
    color: var(--text-secondary);
    transition: all 0.2s;
    border: 1px solid transparent;
}

.os-option.active {
    background: var(--accent-primary);
    color: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.os-option:hover:not(.active) {
    color: var(--text-primary);
    background: rgba(255,255,255,0.05);
}

/* --- Syntax Highlighting --- 
   We simulate code blocks with spans 
*/
.command-line {
    display: block;
    white-space: pre-wrap;
    word-break: break-all;
}
.command-line:hover { background: rgba(255,255,255,0.03); }

.c-dir { color: var(--syntax-dir); font-weight: 500; }
.c-file { color: var(--syntax-file); }

/* --- Toast Notification --- */
.toast-container {
    position: fixed;
    bottom: 30px;
    right: 30px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 100;
}

.toast {
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-left: 4px solid var(--accent-primary);
    padding: 16px 20px;
    border-radius: var(--radius-md);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    color: var(--text-primary);
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: slideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    min-width: 250px;
}

.toast.success { border-left-color: var(--success); }

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes fadeOut {
    to { transform: translateX(20px); opacity: 0; }
}

/* --- Mobile Responsiveness --- */
@media (max-width: 900px) {
    main {
        grid-template-columns: 1fr;
        overflow-y: auto;
        height: auto;
    }
    .panel {
        height: 500px; /* Fixed height on mobile for scroll */
    }
    body { overflow: auto; }
}
</style>
</head>
<body>

<header>
    <div class="brand">
        <!-- UPDATED: Your Logo Image -->
        <!-- If this fails to load, the SVG below will appear automatically -->
        <img src="treetoclilogo.png" class="brand-logo-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'" alt="TreeToCLI Logo">
        
        <!-- Fallback SVG Icon (Hidden by default) -->
        <svg class="brand-logo-svg" viewBox="0 0 24 24">
            <path d="M3 3h18v18H3V3zm16 16V5H5v14h14zM7 7h4v4H7V7zm0 6h4v4H7v-4zm6-6h4v4h-4V7zm0 6h4v4h-4v-4z"/>
        </svg>
        
        TreeToCLI
    </div>
    <div class="header-controls">
        <button class="icon-btn" onclick="saveTemplate()" title="Save to LocalStorage">
            <svg viewBox="0 0 24 24"><path d="M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
        </button>
        <button class="icon-btn" onclick="toggleTheme()" title="Toggle Theme">
            <svg id="theme-icon" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.93c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zm13.42 13.42c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zm-9.19 8.49c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zM19.41 4.93c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41z"/></svg>
        </button>
    </div>
</header>

<main>
    <!-- INPUT PANEL -->
    <section class="panel">
        <div class="panel-header">
            <div class="panel-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                Structure Input
            </div>
            <div class="panel-actions">
                <select id="exampleSelect" class="btn btn-ghost" onchange="loadExample(this.value)">
                    <option value="">Load Example</option>
                    <option value="simple">Simple Project</option>
                    <option value="advanced">Advanced Project</option>
                </select>
                <button class="btn btn-ghost" onclick="loadTemplate()" title="Load Saved">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    Load
                </button>
                <button class="btn btn-ghost" onclick="clearAll()" title="Clear">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
        </div>
        <div class="editor-container">
            <textarea id="structure" placeholder="Paste your folder tree structure here...&#10;project/&#10; ├── src/&#10; │   └── index.js&#10; └── package.json"></textarea>
            <div class="drag-overlay">Drop File Here</div>
        </div>
    </section>

    <!-- OUTPUT PANEL -->
    <section class="panel">
        <div class="panel-header">
            <div class="panel-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H9v-2h6v2zm0-5H9v-2h6v2zm0-5H9V6h6v2z"/></svg>
                Terminal Output
            </div>
            <div class="panel-actions">
                <!-- Custom OS Switcher -->
                <div class="os-switcher" id="osSwitcher">
                    <div class="os-option active" onclick="setOS('linux', this)">Linux/macOS</div>
                    <div class="os-option" onclick="setOS('windows', this)">CMD</div>
                    <div class="os-option" onclick="setOS('powershell', this)">PowerShell</div>
                </div>
                <!-- Hidden actual select for logic reference -->
                <input type="hidden" id="os" value="linux">
            </div>
        </div>
        <div class="output-container" id="output">
            <!-- Output will be injected here -->
            <div style="color:var(--text-secondary); font-style:italic; text-align:center; margin-top:40px;">
                Waiting for input...
            </div>
        </div>
        <div class="panel-header" style="border-top: 1px solid var(--glass-border); border-bottom: none;">
            <div class="panel-actions" style="margin-left: auto;">
                <button class="btn btn-primary" onclick="copyCommand()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    Copy
                </button>
                <button class="btn btn-ghost" onclick="downloadCommand()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    Download
                </button>
            </div>
        </div>
    </section>
</main>

<div class="toast-container" id="toastContainer"></div>

<script>
// --- Core Logic ---
let currentOS = 'linux';

const textarea = document.getElementById("structure");
const outputDiv = document.getElementById("output");

// Initialization
if(localStorage.getItem("treetocli_theme") === "light") {
    document.body.classList.add("light");
    updateThemeIcon();
}

// --- Event Listeners ---
textarea.addEventListener("input", generate);

// Drag & Drop Visuals
textarea.addEventListener("dragover", e => { 
    e.preventDefault(); 
    textarea.classList.add("dragover"); 
});
textarea.addEventListener("dragleave", () => textarea.classList.remove("dragover"));
textarea.addEventListener("drop", e => {
    e.preventDefault();
    textarea.classList.remove("dragover");
    const file = e.dataTransfer.files[0];
    if(file){
        const reader = new FileReader();
        reader.onload = e => { 
            textarea.value = e.target.result; 
            generate(); 
            showToast('File imported successfully', 'success');
        }
        reader.readAsText(file);
    }
});

// --- Functions ---

function setOS(os, element) {
    currentOS = os;
    document.getElementById('os').value = os;
    
    // UI Update for switcher
    document.querySelectorAll('.os-option').forEach(el => el.classList.remove('active'));
    element.classList.add('active');
    
    generate();
}

function generate() {
    const input = textarea.value.trim();
    if (!input) {
        outputDiv.innerHTML = `<div style="color:var(--text-secondary); font-style:italic; text-align:center; margin-top:40px;">Waiting for input...</div>`;
        outputDiv.dataset.raw = "";
        return;
    }

    const lines = textarea.value.split("\n");
    let stack = [], commands = [], coloredHTML = [];

    lines.forEach(line => {
        if (!line.trim()) return;
        
        // Remove tree characters (│, ├, └, ─)
        let cleanLine = line.replace(/[│├└─]/g, "");
        
        // Calculate indent
        let indent = 0;
        let match = cleanLine.match(/^\s*/);
        if(match){ 
            // Assuming 2 spaces or 1 tab = 1 level
            indent = Math.floor(match[0].replace(/\t/g,'  ').length/2); 
        }
        
        cleanLine = cleanLine.trim();
        stack = stack.slice(0, indent);

        let command = "", isDir = cleanLine.endsWith("/");
        
        // Build path
        let fullPath = "";
        if(isDir){
            let dirName = cleanLine.replace("/","");
            stack.push(dirName);
            fullPath = stack.join("/");
            
            // Generate Command based on OS
            if(currentOS === "linux") {
                command = `mkdir -p "${fullPath}"`;
            } else if (currentOS === "windows") {
                command = `mkdir "${fullPath.replace(/\//g,"\\")}"`;
            } else {
                command = `New-Item -ItemType Directory -Path "${fullPath.replace(/\//g,"\\")}" -Force`;
            }
            
            // HTML for highlighting
            coloredHTML.push(`<div class="command-line"><span class="c-dir">${escapeHtml(command)}</span></div>`);
        } else {
            fullPath = [...stack, cleanLine].join("/");
            
            if(currentOS === "linux") {
                command = `touch "${fullPath}"`;
            } else if (currentOS === "windows") {
                command = `type nul > "${fullPath.replace(/\//g,"\\")}"`;
            } else {
                command = `New-Item -ItemType File -Path "${fullPath.replace(/\//g,"\\")}" -Force`;
            }

            coloredHTML.push(`<div class="command-line"><span class="c-file">${escapeHtml(command)}</span></div>`);
        }
        
        commands.push(command);
    });

    outputDiv.innerHTML = coloredHTML.join("");
    outputDiv.dataset.raw = commands.join("\n");
}

// --- Utility Functions ---

function escapeHtml(text) {
    return text
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}

function toggleTheme(){
    document.body.classList.toggle("light");
    const isLight = document.body.classList.contains("light");
    localStorage.setItem("treetocli_theme", isLight ? "light" : "dark");
    updateThemeIcon();
}

function updateThemeIcon() {
    const isLight = document.body.classList.contains("light");
    const iconSvg = document.querySelector("#theme-icon path");
    if(isLight) {
        // Moon icon
        iconSvg.setAttribute("d", "M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z");
    } else {
        // Sun icon
        iconSvg.setAttribute("d", "M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.93c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zm13.42 13.42c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zm-9.19 8.49c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0zM19.41 4.93c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41z");
    }
}

function showToast(message, type = 'normal') {
    const container = document.getElementById('toastContainer');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    
    let icon = '';
    if (type === 'success') {
        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="var(--success)"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>';
    } else {
        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="var(--accent-primary)"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>';
    }

    toast.innerHTML = `${icon}<span>${message}</span>`;
    container.appendChild(toast);

    // Remove after delay
    setTimeout(() => {
        toast.style.animation = 'fadeOut 0.3s forwards';
        toast.addEventListener('animationend', () => {
            toast.remove();
        });
    }, 3000);
}

function copyCommand(){
    const output = outputDiv.dataset.raw || "";
    if(!output) return showToast("Nothing to copy!");
    
    navigator.clipboard.writeText(output).then(() => {
        showToast("Commands copied to clipboard", "success");
    });
}

function downloadCommand(){
    const output = outputDiv.dataset.raw || "";
    if(!output) return showToast("Nothing to download!");
    
    let ext = currentOS === "linux" ? ".sh" : (currentOS === "windows" ? ".bat" : ".ps1");
    const blob = new Blob([output], {type: "text/plain"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `setup_structure${ext}`;
    a.click();
    showToast("Script downloaded", "success");
}

function saveTemplate(){
    localStorage.setItem("treetocli_template", textarea.value);
    showToast("Template saved to browser", "success");
}

function loadTemplate(){
    const saved = localStorage.getItem("treetocli_template");
    if(saved){
        textarea.value = saved;
        generate();
        showToast("Template loaded");
    } else { 
        showToast("No saved template found"); 
    }
}

function clearAll(){
    textarea.value = "";
    generate();
    showToast("Editor cleared");
}

function loadExample(key){
    const examples = {
        simple: `my-app/
 ├── src/
 │   ├── components/
 │   │   └── Button.js
 │   ├── App.js
 │   └── index.css
 ├── public/
 │   └── index.html
 ├── package.json
 └── README.md`,
        advanced: `enterprise-saas/
 ├── backend/
 │   ├── api/
 │   │   ├── controllers/
 │   │   └── routes/
 │   ├── services/
 │   ├── models/
 │   ├── config/
 │   └── server.js
 ├── frontend/
 │   ├── src/
 │   │   ├── assets/
 │   │   ├── hooks/
 │   │   ├── utils/
 │   │   └── main.js
 │   ├── public/
 │   └── package.json
 ├── docker/
 │   ├── Dockerfile
 │   └── docker-compose.yml
 ├── scripts/
 │   ├── deploy.sh
 │   └── migrate_db.sh
 ├── .env.example
 ├── .gitignore
 └── README.md`
    };
    textarea.value = examples[key] || "";
    generate();
    showToast("Example loaded", "success");
}
</script>
</body>
</html>
